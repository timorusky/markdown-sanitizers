# Streaming Buffer and Hook Timing Exploits

## Test 1: Line Boundary Attack
[link](java
script:alert(1))

## Test 2: Reference Across Lines
[link][ref
]
[ref
]: javascript:alert(1)

## Test 3: URL Across Multiple Lines
[link](https://example.com/very/long/path/that/might/cause/buffer/issues
/and/continues/here?param=javascript:alert(1))

## Test 4: HTML Comment Across Lines
<!--
[malicious](javascript:alert(1))
-->

## Test 5: Code Block Boundary
```
[fake link](javascript:alert(1))
```

## Test 6: Table Across Lines
| Header |
|--------|
| [link](javascript:alert(1))
|

## Test 7: Blockquote Boundary
> Quote with
> [malicious link](javascript:alert(1))

## Test 8: List Item Across Lines
- Item one
- Item with [link](
  javascript:alert(1))

## Test 9: Emphasis Across Lines
**Bold text with
[malicious](javascript:alert(1))**

## Test 10: Malformed HTML Across Lines
<div>
[malicious](javascript:alert(1))
</div>

## Test 11: Entity Across Lines
[link](javascript&
#58;alert&
#40;1&
#41;)

## Test 12: Deep Nesting Across Lines
> > > Deep quote
> > > with [link](
> > > javascript:alert(1))

## Test 13: Complex Reference Across Lines
[link1][ref1]
[ref1]: [ref2]
[ref2]: java
script:alert(1)

## Test 14: Mixed Content Boundaries
Normal text
[link](javascript:alert(1))
More text

## Test 15: Buffer Overflow Attempt
This is a very long line that might cause buffer issues with the streaming parser and contains a malicious link [malicious](javascript:alert(1)) embedded within a massive amount of text that could potentially overflow internal buffers or cause parsing issues in the streaming mode of the markdown sanitizer implementation.

## Test 16: Incomplete Markdown at EOF
[incomplete link](javascript:alert(1)